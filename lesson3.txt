/*База данных «Страны и города мира»:
1. Сделать запрос, в котором мы выберем все данные о городе – регион, страна.
2. Выбрать все города из Московской области.
База данных «Сотрудники»:
1. Выбрать среднюю зарплату по отделам.
2. Выбрать максимальную зарплату у сотрудника.
3. Удалить одного сотрудника, у которого максимальная зарплата.
4. Посчитать количество сотрудников во всех отделах.
5. Найти количество сотрудников в отделах и посмотреть, сколько всего денег получает отдел.
*/

select ct.*, r.title, c.title from _cities ct, _regions r, _countries c
 where ct.region_id = r.id 
and r.country_id = c.id;

select ct.*, r.title, c.title, r.id from _cities ct, _regions r, _countries c
 where ct.region_id = r.id 
and r.country_id = c.id
and r.id = 1053480 /*and r.title = 'Московская область'*/;

select avg(salary), d.dept_name from departments d, salaries s, employees e, dept_emp de
where d.dept_no = de.dept_no and e.emp_no = de.emp_no and s.emp_no = e.emp_no group by d.dept_name;

select max(salary), e.first_name, e.last_name, e.emp_no from salaries s, employees e
where s.emp_no = e.emp_no group by e.emp_no order by 1 desc;

/* '158220','Tokuyasu','Pesch','43624'
select * from employees where emp_no = 43624*/
select * from employees where emp_no = 
(SELECT emp_no FROM salaries GROUP BY emp_no HAVING MAX(salary) > 25000 order by max(salary)desc limit 1);
delete from employees where emp_no =
(SELECT emp_no FROM salaries GROUP BY emp_no HAVING MAX(salary) > 25000 order by max(salary)desc limit 1);

select count(e.emp_no), d.dept_name from departments d, employees e, dept_emp de
where d.dept_no = de.dept_no and e.emp_no = de.emp_no group by de.dept_no;

select sum(salary), count(distinct e.emp_no), d.dept_name from departments d, salaries s, employees e, dept_emp de
where d.dept_no = de.dept_no and e.emp_no = de.emp_no and s.emp_no = e.emp_no group by d.dept_name;






